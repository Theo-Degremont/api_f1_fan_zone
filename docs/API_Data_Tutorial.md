# üèéÔ∏è Tutoriel - Ajout de donn√©es dans l'API F1 Fan Zone

## üìã Table des mati√®res
1. [Configuration de base](#configuration-de-base)
2. [Ajout d'√©quipes (Teams)](#ajout-d√©quipes-teams)
3. [Ajout de pilotes (Drivers)](#ajout-de-pilotes-drivers)
4. [Ajout de courses (Races)](#ajout-de-courses-races)
5. [Ajout de r√©sultats (RaceResults)](#ajout-de-r√©sultats-raceresults)
6. [Ajout de classements](#ajout-de-classements)
7. [Scripts d'automatisation](#scripts-dautomatisation)

---

## Configuration de base

### üîë Authentification
Toutes les requ√™tes n√©cessitent une cl√© API dans le header :
```bash
X-API-Key: your-api-key-here
```

### üîê Routes s√©curis√©es
Certaines routes n√©cessitent un token JWT en plus de la cl√© API :
```bash
Authorization: Bearer your-jwt-token-here
```

### üåê URL de base
```
http://localhost:3000
```

---

## Ajout d'√©quipes (Teams)

### ‚úÖ Route publique (cl√© API uniquement)
```bash
POST /teams
```

### üìù Structure des donn√©es
```json
{
  "key": "mercedes",
  "name": "Mercedes-AMG Petronas F1 Team",
  "date_start": "2010-01-01T00:00:00Z",
  "date_end": null,
  "nb_victory": 125,
  "nb_podiums": 290,
  "nb_pole": 135,
  "color": "#00D2BE",
  "nb_championship": 8,
  "nb_race": 280
}
```

### üöÄ Exemple avec curl
```bash
curl -X POST http://localhost:3000/teams \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "key": "mercedes",
    "name": "Mercedes-AMG Petronas F1 Team",
    "date_start": "2010-01-01T00:00:00Z",
    "date_end": null,
    "nb_victory": 125,
    "nb_podiums": 290,
    "nb_pole": 135,
    "color": "#00D2BE",
    "nb_championship": 8,
    "nb_race": 280
  }'
```

### üìä Exemples d'√©quipes 2024
```json
// Red Bull Racing
{
  "key": "red-bull",
  "name": "Oracle Red Bull Racing",
  "date_start": "2005-01-01T00:00:00Z",
  "date_end": null,
  "nb_victory": 115,
  "color": "#0600EF",
  "nb_championship": 6,
  "nb_race": 380
}

// Ferrari
{
  "key": "ferrari",
  "name": "Scuderia Ferrari",
  "date_start": "1950-01-01T00:00:00Z",
  "date_end": null,
  "nb_victory": 245,
  "color": "#DC143C",
  "nb_championship": 16,
  "nb_race": 1050
}

// McLaren
{
  "key": "mclaren",
  "name": "McLaren Formula 1 Team",
  "date_start": "1966-01-01T00:00:00Z",
  "date_end": null,
  "nb_victory": 185,
  "color": "#FF8700",
  "nb_championship": 8,
  "nb_race": 900
}
```

---

## Ajout de pilotes (Drivers)

### ‚úÖ Route publique (cl√© API uniquement)
```bash
POST /drivers
```

### üìù Structure des donn√©es
```json
{
  "key": "hamilton-lewis",
  "name": "Lewis",
  "surname": "Hamilton",
  "number": 44,
  "nb_championship": 7,
  "nb_pole": 104,
  "nb_podiums": 198,
  "nb_race": 350,
  "nb_victory": 103,
  "current_team_id": 1
}
```

### üöÄ Exemple avec curl
```bash
curl -X POST http://localhost:3000/drivers \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "key": "hamilton-lewis",
    "name": "Lewis",
    "surname": "Hamilton",
    "number": 44,
    "nb_championship": 7,
    "nb_pole": 104,
    "nb_podiums": 198,
    "nb_race": 350,
    "nb_victory": 103,
    "current_team_id": 1
  }'
```

### üìä Exemples de pilotes 2024
```json
// Max Verstappen
{
  "key": "verstappen-max",
  "name": "Max",
  "surname": "Verstappen",
  "number": 1,
  "nb_championship": 3,
  "nb_pole": 34,
  "nb_race": 180,
  "nb_victory": 56,
  "current_team_id": 2
}

// Charles Leclerc
{
  "key": "leclerc-charles",
  "name": "Charles",
  "surname": "Leclerc",
  "number": 16,
  "nb_championship": 0,
  "nb_pole": 25,
  "nb_race": 130,
  "nb_victory": 5,
  "current_team_id": 3
}

// Lando Norris
{
  "key": "norris-lando",
  "name": "Lando",
  "surname": "Norris",
  "number": 4,
  "nb_championship": 0,
  "nb_pole": 7,
  "nb_race": 120,
  "nb_victory": 4,
  "current_team_id": 4
}
```

---

## Ajout de courses (Races)

### ‚úÖ Route publique (cl√© API uniquement)
```bash
POST /races
```

### üìù Structure des donn√©es
```json
{
  "race_name": "Monaco Grand Prix",
  "track_name": "Circuit de Monaco",
  "country": "Monaco",
  "city": "Monte Carlo",
  "started_at": "2024-05-26T15:00:00Z",
  "nb_laps": 78,
  "nb_curve": 19,
  "duration": 6180000
}
```

### üöÄ Exemple avec curl
```bash
curl -X POST http://localhost:3000/races \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "race_name": "Monaco Grand Prix",
    "track_name": "Circuit de Monaco",
    "country": "Monaco",
    "city": "Monte Carlo",
    "started_at": "2024-05-26T15:00:00Z",
    "nb_laps": 78,
    "nb_curve": 19,
    "duration": 6180000
  }'
```

### üìä Exemples de courses 2024
```json
// Bahrain GP
{
  "race_name": "Bahrain Grand Prix",
  "track_name": "Bahrain International Circuit",
  "country": "Bahrain",
  "city": "Sakhir",
  "started_at": "2024-03-02T15:00:00Z",
  "nb_laps": 57,
  "nb_curve": 15,
  "duration": 5400000
}

// Saudi Arabian GP
{
  "race_name": "Saudi Arabian Grand Prix",
  "track_name": "Jeddah Corniche Circuit",
  "country": "Saudi Arabia",
  "city": "Jeddah",
  "started_at": "2024-03-09T18:00:00Z",
  "nb_laps": 50,
  "nb_curve": 27,
  "duration": 5100000
}

// Australian GP
{
  "race_name": "Australian Grand Prix",
  "track_name": "Albert Park Circuit",
  "country": "Australia",
  "city": "Melbourne",
  "started_at": "2024-03-24T05:00:00Z",
  "nb_laps": 58,
  "nb_curve": 16,
  "duration": 5280000
}
```

---

## Ajout de r√©sultats (RaceResults)

### ‚úÖ Route publique (cl√© API uniquement)
```bash
POST /race-results
```

### üìù Structure des donn√©es
```json
{
  "race_id": 1,
  "driver_id": 1,
  "position": 1,
  "points": 25,
  "fastest_lap": "2024-05-26T15:45:32Z",
  "lap_time": 74528,
  "total_time": 5825000,
  "status": "FINISHED"
}
```

### üöÄ Exemple avec curl
```bash
curl -X POST http://localhost:3000/race-results \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "race_id": 1,
    "driver_id": 1,
    "position": 1,
    "points": 25,
    "fastest_lap": "2024-05-26T15:45:32Z",
    "lap_time": 74528,
    "total_time": 5825000,
    "status": "FINISHED"
  }'
```

### üìä Exemple de podium Monaco 2024
```json
// 1er place - Charles Leclerc
{
  "race_id": 1,
  "driver_id": 3,
  "position": 1,
  "points": 25,
  "fastest_lap": "2024-05-26T15:45:32Z",
  "lap_time": 74528,
  "total_time": 5825000,
  "status": "FINISHED"
}

// 2√®me place - Oscar Piastri
{
  "race_id": 1,
  "driver_id": 5,
  "position": 2,
  "points": 18,
  "fastest_lap": "2024-05-26T15:47:15Z",
  "lap_time": 74892,
  "total_time": 5830000,
  "status": "FINISHED"
}

// 3√®me place - Carlos Sainz
{
  "race_id": 1,
  "driver_id": 6,
  "position": 3,
  "points": 15,
  "fastest_lap": "2024-05-26T15:46:45Z",
  "lap_time": 75124,
  "total_time": 5835000,
  "status": "FINISHED"
}

// DNF - George Russell
{
  "race_id": 1,
  "driver_id": 7,
  "position": 0,
  "points": 0,
  "fastest_lap": null,
  "lap_time": null,
  "total_time": null,
  "status": "DNF"
}
```

### üìã Status possibles
- `FINISHED` : Course termin√©e
- `DNF` : Did Not Finish (abandon)
- `DSQ` : Disqualified (disqualifi√©)
- `DNS` : Did Not Start (n'a pas pris le d√©part)

---

## Ajout de classements

### üèÜ Classement des pilotes

#### Route s√©curis√©e (JWT requis)
```bash
POST /classement-drivers
```

```json
{
  "season": 2024,
  "id_driver": 1,
  "position": 1,
  "points": 575
}
```

#### Exemple complet saison 2024
```bash
curl -X POST http://localhost:3000/classement-drivers \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -H "Authorization: Bearer your-jwt-token" \
  -d '{
    "season": 2024,
    "id_driver": 1,
    "position": 1,
    "points": 575
  }'
```

### üèÅ Classement des √©quipes

#### Route s√©curis√©e (JWT requis)
```bash
POST /classement-teams
```

```json
{
  "season": 2024,
  "id_team": 1,
  "position": 1,
  "points": 765
}
```

---

## Scripts d'automatisation

### üîß Script pour ajouter une saison compl√®te

Cr√©ons un script qui ajoute des donn√©es pour une saison compl√®te :

```javascript
// scripts/add-season-data.js
const axios = require('axios');

const API_BASE = 'http://localhost:3000';
const API_KEY = 'your-api-key-here';
const JWT_TOKEN = 'your-jwt-token-here';

const headers = {
  'Content-Type': 'application/json',
  'X-API-Key': API_KEY
};

const authHeaders = {
  ...headers,
  'Authorization': `Bearer ${JWT_TOKEN}`
};

async function addTeams() {
  const teams = [
    {
      key: "mercedes",
      name: "Mercedes-AMG Petronas F1 Team",
      date_start: "2010-01-01T00:00:00Z",
      nb_victory: 125,
      color: "#00D2BE",
      nb_championship: 8,
      nb_race: 280
    },
    {
      key: "red-bull",
      name: "Oracle Red Bull Racing",
      date_start: "2005-01-01T00:00:00Z",
      nb_victory: 115,
      color: "#0600EF",
      nb_championship: 6,
      nb_race: 380
    }
    // ... autres √©quipes
  ];

  for (const team of teams) {
    try {
      const response = await axios.post(`${API_BASE}/teams`, team, { headers });
      console.log(`‚úÖ √âquipe ajout√©e: ${team.name}`);
    } catch (error) {
      console.error(`‚ùå Erreur √©quipe ${team.name}:`, error.response?.data);
    }
  }
}

async function addDrivers() {
  const drivers = [
    {
      key: "hamilton-lewis",
      name: "Lewis",
      surname: "Hamilton",
      number: 44,
      nb_championship: 7,
      nb_pole: 104,
      nb_race: 350,
      nb_victory: 103,
      current_team_id: 1
    }
    // ... autres pilotes
  ];

  for (const driver of drivers) {
    try {
      const response = await axios.post(`${API_BASE}/drivers`, driver, { headers });
      console.log(`‚úÖ Pilote ajout√©: ${driver.name} ${driver.surname}`);
    } catch (error) {
      console.error(`‚ùå Erreur pilote ${driver.name}:`, error.response?.data);
    }
  }
}

async function main() {
  console.log('üöÄ D√©but de l\'ajout des donn√©es...');
  
  await addTeams();
  await addDrivers();
  // await addRaces();
  // await addRaceResults();
  
  console.log('‚úÖ Donn√©es ajout√©es avec succ√®s !');
}

main().catch(console.error);
```

### üèÉ‚Äç‚ôÇÔ∏è Utilisation du script
```bash
cd /path/to/your/project
npm install axios
node scripts/add-season-data.js
```

---

## üì° Routes de consultation

### √âquipes
- `GET /teams` - Liste toutes les √©quipes (public)
- `GET /teams/:id` - √âquipe par ID (JWT requis)
- `GET /teams/key/:key` - √âquipe par cl√© (JWT requis)

### Pilotes
- `GET /drivers` - Liste tous les pilotes (public)
- `GET /drivers/:id` - Pilote par ID (JWT requis)
- `GET /drivers/key/:key` - Pilote par cl√© (JWT requis)

### Courses
- `GET /races` - Liste toutes les courses (public)
- `GET /races/:id` - Course par ID (JWT requis)

### R√©sultats
- `GET /race-results` - Tous les r√©sultats (public)
- `GET /race-results/:id` - R√©sultat par ID (JWT requis)
- `GET /race-results/race/:raceId` - R√©sultats d'une course (JWT requis)

### Classements
- `GET /classement-drivers` - Classement pilotes (JWT requis)
- `GET /classement-teams` - Classement √©quipes (JWT requis)

---

## üí° Conseils et bonnes pratiques

### üîë Cl√©s uniques
- Utilisez des cl√©s descriptives : `hamilton-lewis`, `mercedes`, etc.
- Format recommand√© : `nom-prenom` ou `nom-equipe`
- Les cl√©s sont uniques et ne peuvent pas √™tre dupliqu√©es

### ‚è±Ô∏è Gestion des dates
- Format ISO 8601 : `2024-05-26T15:00:00Z`
- Utilisez UTC pour √©viter les probl√®mes de fuseaux horaires

### üé® Couleurs des √©quipes
- Format hexad√©cimal : `#FF0000`
- Toujours 7 caract√®res (# + 6 caract√®res hex)

### üî¢ Num√©ros de pilotes
- Doivent √™tre uniques
- G√©n√©ralement entre 1 et 99
- Le num√©ro 1 est r√©serv√© au champion du monde

### üìä Points de course
- 1er : 25 points
- 2√®me : 18 points
- 3√®me : 15 points
- 4√®me : 12 points
- 5√®me : 10 points
- 6√®me : 8 points
- 7√®me : 6 points
- 8√®me : 4 points
- 9√®me : 2 points
- 10√®me : 1 point
- DNF/DSQ/DNS : 0 point

---

## üö® Gestion des erreurs

### Erreurs courantes

#### 409 - Cl√© d√©j√† existante
```json
{
  "error": "Driver key already exists",
  "field": "key"
}
```

#### 400 - Donn√©es invalides
```json
{
  "error": "Color must be in hexadecimal format (#RRGGBB)"
}
```

#### 401 - Non autoris√©
```json
{
  "error": "No API key provided"
}
```

#### 404 - Non trouv√©
```json
{
  "error": "Team not found"
}
```

---

## üìû Support

Pour toute question ou probl√®me :
1. V√©rifiez les logs du serveur
2. Consultez la documentation des erreurs
3. Testez avec Postman ou curl

Bon d√©veloppement ! üèéÔ∏èüí®
